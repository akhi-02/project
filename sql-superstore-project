
-- CHECK THE FIRST 5 ROWS TO MAKE SURE IT IMPORTED WELL

SELECT * FROM SUPERSTORE LIMIT 5;

-- 1.WHAT ARE TOTAL SALES AND TOTAL PROFITS OF EACH YEAR

SELECT 
YEAR(`ORDER DATE`) AS YEAR,
ROUND(SUM(SALES),2) AS TOTAL_SALE,
ROUND(SUM(PROFIT),2) AS TOTAL_PROFIT
FROM SUPERSTORE
GROUP BY YEAR(`ORDER DATE`)
ORDER BY YEAR asc
LIMIT 0,1000;

-- 2. WHAT ARE THE TOTAL SALES AND TOTAL PROFITS PER QUARTER

SELECT 
YEAR(`ORDER DATE`) AS YEAR,
CASE 
WHEN MONTH(`ORDER DATE`) IN (1,2,3) THEN 'Q1'
WHEN MONTH(`ORDER DATE`) IN (4,5,6) THEN 'Q2'
WHEN MONTH(`ORDER DATE`) IN (7,8,9) THEN 'Q3'
ELSE 'Q4'
END AS QUARTERS,
ROUND(SUM(SALES),2) AS TOTAL_SALES,
ROUND(SUM(PROFIT),2) AS TOTAL_PROFITS
FROM SUPERSTORE
GROUP BY YEAR,QUARTERS
ORDER BY YEAR,QUARTERS; 


-- 3. WHAT REGION GENERATES THE HIGHEST SALES AND PROFITS

SELECT REGION ,SUM(SALES) AS TOTAL_SALE,SUM(PROFIT) AS TOTAL_PROFITS
FROM SUPERSTORE
GROUP BY REGION
ORDER BY TOTAL_PROFITS DESC
LIMIT 1;


-- EACH REGION PROFIT MARGIN FOR FURTHER ANALYSIS
-- ROUND(SUM(PROFIT)/SUM(SALES))*100,2)AS PROFIT_MARGIN;

SELECT REGION , ROUND((SUM(PROFIT)/SUM(SALES))*100,2) 
AS PROFIT_MARGIN
FROM SUPERSTORE
GROUP BY REGION
ORDER BY PROFIT_MARGIN DESC;



-- 4. WHAT STATE AND CITY BRINGS IN THE HIGHEST SALES AND PROFITS

SELECT STATE,ROUND(SUM(SALES),2) AS TOTAL_SALES,
ROUND(SUM(PROFIT),2) AS TOTAL_PROFITS,ROUND((SUM(PROFIT)/SUM(SALES))*100,2) 
AS PROFIT_MARGIN
FROM SUPERSTORE
GROUP BY STATE
ORDER BY PROFIT_MARGIN DESC
LIMIT 10;

-- OBSERVE OUR BOTTOM 10 STATES
SELECT STATE,ROUND(SUM(SALES),2) AS TOTAL_SALES,ROUND(SUM(PROFIT),2) AS TOTAL_PROFIT
FROM SUPERSTORE
GROUP BY STATE 
ORDER BY TOTAL_PROFIT ASC LIMIT 10;

-- TOP CITIES ARE
SELECT CITY,ROUND(SUM(SALES),2) AS TOTAL_SALES,ROUND(SUM(PROFIT),2) AS TOTAL_PROFIT,
ROUND((SUM(PROFIT)/SUM(SALES))*100,2) AS TOTAL_MARGIN
FROM SUPERSTORE
GROUP BY CITY
ORDER BY TOTAL_PROFIT DESC LIMIT 10;

-- TOP BOTTAM 10 CITIES

SELECT CITY,ROUND(SUM(SALES),2) AS TOTAL_SALES,ROUND(SUM(PROFIT),2) AS TOTAL_PROFIT,
ROUND((SUM(PROFIT)/SUM(SALES))*100,2) AS TOTAL_MARGIN
FROM SUPERSTORE
GROUP BY CITY
ORDER BY TOTAL_PROFIT ASC LIMIT 10;

-- 5. THE RELATIONSHIP BETWEEN DISCOUNT AND SALES AND THE TOTAL DISCOUNT PER CATEGORY

SELECT DISCOUNT,ROUND(AVG(SALES),2) AS AVG_SALES
FROM SUPERSTORE
GROUP BY DISCOUNT
ORDER BY DISCOUNT;
-- TOTAL DISCOUNT PER PRODUCT CATEGORY

SELECT CATEGORY,ROUND(SUM(DISCOUNT),2) AS TOTAL_DISCOUNT
FROM SUPERSTORE
GROUP BY CATEGORY
ORDER BY TOTAL_DISCOUNT DESC;

-- WHAT TYPE OF PRODUCT S ARE THE MOST DISCOUNTED

SELECT CATEGORY,`SUB-CATEGORY`,ROUND(SUM(DISCOUNT),2) AS TOTAL_DISCOUNT
FROM SUPERSTORE
GROUP BY CATEGORY,`SUB-CATEGORY`
ORDER BY TOTAL_DISCOUNT DESC  ;

-- 6. WHAT CATEGORY GENERATES THE HIGHEST SALES AND PROFIT IN EACH REGION AND STATE

SELECT CATEGORY,ROUND(SUM(SALES),2) AS TOTAL_SALES,
ROUND(SUM(PROFIT),2) AS TOTAL_PROFIT,ROUND((SUM(PROFIT)/SUM(SALES))*100,2) AS PROFIT_MARGIN 
FROM SUPERSTORE
GROUP BY CATEGORY
ORDER BY TOTAL_PROFIT DESC ;

-- HIGHEST TOTAL SATES AND TOTAL PROFITS PER CATEGORY IN EACH REGION

SELECT CATEGORY,REGION,ROUND(SUM(SALES),2) AS TOTAL_SALES,
ROUND(SUM(PROFIT),2) AS TOTAL_PROFIT 
FROM SUPERSTORE
GROUP BY CATEGORY,REGION
ORDER BY TOTAL_PROFIT DESC;

          (or)
            
/* SELECT `SUB-CATEGORY`,REGION,ROUND(SUM(SALES),2) AS TOTAL_SALES,
ROUND(SUM(PROFIT),2) AS TOTAL_PROFIT FROM SUPERSTORE
GROUP BY `SUB-CATEGORY`,REGION
ORDER BY TOTAL_PROFIT desc
LIMIT 5 ;*/

-- HIGHEST TOTAL SATES AND TOTAL PROFITS PER CATEGORY IN EACH STATE
            
SELECT CATEGORY,STATE,ROUND(SUM(SALES),2) AS TOTAL_SALES,
ROUND(SUM(PROFIT),2) AS TOTAL_PROFIT 
FROM SUPERSTORE
GROUP BY CATEGORY,STATE
ORDER BY TOTAL_PROFIT DESC;

-- Check the least profitable ones by just changing our ‘ORDER BY’ clause too ascending (ASC) 

SELECT CATEGORY,STATE,ROUND(SUM(SALES),2) AS TOTAL_SALES,
ROUND(SUM(PROFIT),2) AS TOTAL_PROFIT 
FROM SUPERSTORE
GROUP BY CATEGORY,STATE
ORDER BY TOTAL_PROFIT ASC;

-- 7.	What subcategory generates the highest sales and profits in each region and state ?

SELECT `SUB-CATEGORY`,REGION,ROUND(SUM(SALES),2) AS TOTAL_SALES,
ROUND(SUM(PROFIT),2) AS TOTAL_PROFIT,ROUND((SUM(PROFIT)/SUM(SALES))*100,2) AS TOTAL_MARGIN 
FROM SUPERSTORE
GROUP BY `SUB-CATEGORY`,REGION
ORDER BY TOTAL_PROFIT DESC;

-- Highest total sales and total profits per subcategory in each region

SELECT `SUB-CATEGORY`,REGION,ROUND(SUM(SALES),2) AS TOTAL_SALES,
ROUND(SUM(PROFIT),2) AS TOTAL_PROFIT FROM SUPERSTORE
GROUP BY `SUB-CATEGORY`, REGION
ORDER BY TOTAL_PROFIT DESC ;

-- Least performing ones

SELECT `SUB-CATEGORY`,REGION,ROUND(SUM(SALES),2) AS TOTAL_SALES,
ROUND(SUM(PROFIT),2) AS TOTAL_PROFIT FROM SUPERSTORE
GROUP BY `SUB-CATEGORY`, REGION
ORDER BY TOTAL_PROFIT ;

-- What are the names of the products that are the most and least profitable to us?

SELECT `PRODUCT NAME`,ROUND(SUM(PROFIT),2) AS TOTAL_PROFIT,ROUND(SUM(PROFIT),2) AS TOTAL_PROFIT
FROM SUPERSTORE
GROUP BY `PRODUCT NAME`
ORDER BY TOTAL_PROFIT DESC ;


--  Highest total sales and total profits per subcategory in each state
--  9.	What segment makes the most of our profits and sales ?

SELECT SEGMENT,ROUND(SUM(SALES),2) AS TOTAL_SALES,
ROUND(SUM(PROFIT),2) AS TOTAL_PROFIT
FROM SUPERSTORE
GROUP BY SEGMENT
ORDER BY TOTAL_PROFIT DESC;


-- 10.	How many customers do we have (unique customer IDs) in total and how much per region and state?
SELECT  DISTINCT COUNT(`CUSTOMER ID`) AS NUM_CUST,STATE,REGION
FROM SUPERSTORE
GROUP BY STATE,REGION;

SELECT COUNT( DISTINCT `CUSTOMER ID`) AS TOTAL_CUSTOMERS FROM SUPERSTORE;

-- REGION WISE

SELECT REGION, COUNT( DISTINCT `CUSTOMER ID`) AS TOTAL_CUSTOMERS 
FROM SUPERSTORE
GROUP BY REGION
ORDER BY TOTAL_CUSTOMERS DESC;

-- STATE-WISE

SELECT STATE, COUNT( DISTINCT `CUSTOMER ID`) AS TOTAL_CUSTOMERS 
FROM SUPERSTORE
GROUP BY STATE
ORDER BY TOTAL_CUSTOMERS DESC;

 -- 11.	Customer rewards program - What customers spent the most with us?

 SELECT `CUSTOMER ID`,SUM(SALES) AS TOTAL_SALES
 FROM SUPERSTORE
 GROUP BY `CUSTOMER ID`
 ORDER BY TOTAL_SALES DESC
 LIMIT 15;

-- 12.	Average shipping time per class and in total

SELECT ROUND(AVG(`SHIP DATE` - `ORDER DATE`),2) AS AVG_SHIPPING_TIME
FROM SUPERSTORE;

-- SHIP MODE
SELECT 
`SHIP MODE`,
ROUND(AVG(`SHIP DATE` - `ORDER DATE`),1) AS AVG_SHIPPING_TIME
FROM SUPERSTORE
GROUP BY `SHIP MODE` 
 ORDER BY AVG_SHIPPING_TIME ;
